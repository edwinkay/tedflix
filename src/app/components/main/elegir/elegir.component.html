<div class="viewer-container" *ngIf="ocultar">
  <h2>¿Quién está viendo?</h2>
  <div class="viewer-list">
    <div style="display: contents" *ngFor="let user of users; let i = index">
      <div class="viewer" *ngFor="let perfil of user.perfil; let j = index">
        <img (click)="hide()" [src]="perfil.image" [alt]="perfil.name" />
        <div class="viewer-info">
          <p *ngIf="!isEditing || (isEditing && editingIndex !== j)">
            {{ perfil.name }}
          </p>

          <input
            *ngIf="isEditing && editingIndex === j"
            [(ngModel)]="perfil.name"
            (blur)="finishEditing(j)"
          />

          <div *ngIf="isManaging">
            <ion-icon
              name="pencil-outline"
              (click)="startEditing(j)"
            ></ion-icon>
            <ion-icon
              *ngIf="j !== 0"
              name="trash-outline"
              (click)="removeProfile(j, i)"
            ></ion-icon>
          </div>
        </div>
      </div>
    </div>
    <!-- Mostrar el botón solo si hay menos de 4 perfiles en total -->
    <div
      class="viewer add-profile"
      *ngIf="getProfileCount() < 4"
      (click)="onAddProfile()"
    >
      <div class="add-icon">+</div>
      <p>Añadir perfil</p>
    </div>
  </div>

  <!-- Botón para administrar perfiles -->
  <div class="manage-profiles">
    <a (click)="toggleManaging()">{{
      isManaging ? "Listo" : "Administrar perfiles"
    }}</a>
  </div>
</div>

<div *ngIf="!ocultar" class="welcome-container">
  <div class="margen">
    <div class="overlay"></div>

    <header>
      <div class="netflix-logo">
        <span>T</span>
        <span>E</span>
        <span>D</span>
        <span>F</span>
        <span>L</span>
        <span>I</span>
        <span>X</span>
      </div>
      <div class="navbar">
        <a href="#">Inicio</a>
        <a href="#">Series</a>
        <a href="#">Películas</a>
        <a href="#">Novedades</a>
        <a href="#">Mi Lista</a>
      </div>
      <div>
        <ion-buttons slot="end">
          <ion-button>
            <ion-icon name="search-outline"></ion-icon>
          </ion-button>
          <ion-button>
            <ion-icon name="notifications-outline"></ion-icon>
          </ion-button>
          <ion-button>
            <ion-icon name="person-circle-outline"></ion-icon>
          </ion-button>
        </ion-buttons>
      </div>
    </header>

    <div class="container">
      <!-- Sección del carrusel de contenido destacado -->
      <div class="featured-content">
        <img
          src="https://firebasestorage.googleapis.com/v0/b/tedflix-3dc61.appspot.com/o/movies%2Fbackdrop.jpg?alt=media&token=9e185a2d-7275-49ed-ac47-9ca737cee88c"
          alt="Destacado"
        />
        <div class="featured-info">
          <h2>Película Destacada</h2>
          <p>Descripción breve de la película destacada...</p>
          <ion-button color="danger">Ver ahora</ion-button>
          <ion-button fill="outline">Mi lista</ion-button>
        </div>
      </div>

      <!-- Secciones de películas (Tendencias, Nuevos lanzamientos, etc.) -->
        <div *ngFor="let category of categorias">
    <div *ngFor="let key of getKeys(category.categorias)">
      <h3>{{ key }}</h3>
      <div class="carousel-container">
        <button (click)="prevSlide(category, key)" class="carousel-button carousel-button-prev">&#10094;</button>

        <div class="carousel-wrapper">
          <div class="carousel-images" [style.transform]="getTransform(category, key)">
            <div *ngFor="let movie of getVisibleMovies(category, key)" class="carousel-item">
              <img [src]="movie.image" [alt]="movie.title" class="movie-poster"/>
              <p>{{ movie.title }}</p>
            </div>
          </div>
        </div>

        <button (click)="nextSlide(category, key)" class="carousel-button carousel-button-next">&#10095;</button>
      </div>
    </div>
  </div>
    </div>
  </div>
</div>
